{"version":3,"names":["UIPlugin","packageJson","ReduxDevTools","constructor","uppy","opts","type","id","title","defaultOptions","handleStateChange","bind","initDevTools","prevState","nextState","devTools","send","window","devToolsExtension","connect","devToolsUnsubscribe","subscribe","message","payload","cancelAll","computedStates","nextLiftedState","store","state","getState","length","updateAll","JSON","parse","install","withDevTools","__REDUX_DEVTOOLS_EXTENSION__","on","uninstall","off","handleStateUpdate","VERSION","version"],"sources":["index.js"],"sourcesContent":["import { UIPlugin } from '@uppy/core'\n\nimport packageJson from '../package.json'\n\n/* eslint-disable max-len */\n/**\n * Add Redux DevTools support to Uppy\n *\n * See https://medium.com/@zalmoxis/redux-devtools-without-redux-or-how-to-have-a-predictable-state-with-any-architecture-61c5f5a7716f\n * and https://github.com/zalmoxisus/mobx-remotedev/blob/master/src/monitorActions.js\n */\n/* eslint-enable max-len */\nexport default class ReduxDevTools extends UIPlugin {\n  static VERSION = packageJson.version\n\n  constructor (uppy, opts) {\n    super(uppy, opts)\n    this.type = 'debugger'\n    this.id = this.opts.id || 'ReduxDevTools'\n    this.title = 'Redux DevTools'\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = { ...defaultOptions, ...opts }\n\n    this.handleStateChange = this.handleStateChange.bind(this)\n    this.initDevTools = this.initDevTools.bind(this)\n  }\n\n  handleStateChange (prevState, nextState) {\n    this.devTools.send('UPPY_STATE_UPDATE', nextState)\n  }\n\n  initDevTools () {\n    this.devTools = window.devToolsExtension.connect()\n    this.devToolsUnsubscribe = this.devTools.subscribe((message) => {\n      if (message.type === 'DISPATCH') {\n        // Implement monitors actions\n        switch (message.payload.type) {\n          case 'RESET':\n            this.uppy.cancelAll()\n            return\n          case 'IMPORT_STATE': {\n            const { computedStates } = message.payload.nextLiftedState\n            this.uppy.store.state = { ...this.uppy.getState(), ...computedStates[computedStates.length - 1].state }\n            this.uppy.updateAll(this.uppy.getState())\n            return\n          }\n          case 'JUMP_TO_STATE':\n          case 'JUMP_TO_ACTION':\n            this.uppy.store.state = { ...this.uppy.getState(), ...JSON.parse(message.state) }\n            this.uppy.updateAll(this.uppy.getState())\n            break\n\n          default:\n        }\n      }\n    })\n  }\n\n  install () {\n    // eslint-disable-next-line no-underscore-dangle\n    this.withDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__\n    if (this.withDevTools) {\n      this.initDevTools()\n      this.uppy.on('state-update', this.handleStateChange)\n    }\n  }\n\n  uninstall () {\n    if (this.withDevTools) {\n      this.devToolsUnsubscribe()\n      this.uppy.off('state-update', this.handleStateUpdate)\n    }\n  }\n}\n"],"mappings":"AAAA,SAASA,QAAT,QAAyB,YAAzB;MAEOC,W;;;AAEP;;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;;AACA,eAAe,MAAMC,aAAN,SAA4BF,QAA5B,CAAqC;EAGlDG,WAAW,CAAEC,IAAF,EAAQC,IAAR,EAAc;IACvB,MAAMD,IAAN,EAAYC,IAAZ;IACA,KAAKC,IAAL,GAAY,UAAZ;IACA,KAAKC,EAAL,GAAU,KAAKF,IAAL,CAAUE,EAAV,IAAgB,eAA1B;IACA,KAAKC,KAAL,GAAa,gBAAb,CAJuB,CAMvB;;IACA,MAAMC,cAAc,GAAG,EAAvB,CAPuB,CASvB;;IACA,KAAKJ,IAAL,GAAY,EAAE,GAAGI,cAAL;MAAqB,GAAGJ;IAAxB,CAAZ;IAEA,KAAKK,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAzB;IACA,KAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;EACD;;EAEDD,iBAAiB,CAAEG,SAAF,EAAaC,SAAb,EAAwB;IACvC,KAAKC,QAAL,CAAcC,IAAd,CAAmB,mBAAnB,EAAwCF,SAAxC;EACD;;EAEDF,YAAY,GAAI;IACd,KAAKG,QAAL,GAAgBE,MAAM,CAACC,iBAAP,CAAyBC,OAAzB,EAAhB;IACA,KAAKC,mBAAL,GAA2B,KAAKL,QAAL,CAAcM,SAAd,CAAyBC,OAAD,IAAa;MAC9D,IAAIA,OAAO,CAAChB,IAAR,KAAiB,UAArB,EAAiC;QAC/B;QACA,QAAQgB,OAAO,CAACC,OAAR,CAAgBjB,IAAxB;UACE,KAAK,OAAL;YACE,KAAKF,IAAL,CAAUoB,SAAV;YACA;;UACF,KAAK,cAAL;YAAqB;cACnB,MAAM;gBAAEC;cAAF,IAAqBH,OAAO,CAACC,OAAR,CAAgBG,eAA3C;cACA,KAAKtB,IAAL,CAAUuB,KAAV,CAAgBC,KAAhB,GAAwB,EAAE,GAAG,KAAKxB,IAAL,CAAUyB,QAAV,EAAL;gBAA2B,GAAGJ,cAAc,CAACA,cAAc,CAACK,MAAf,GAAwB,CAAzB,CAAd,CAA0CF;cAAxE,CAAxB;cACA,KAAKxB,IAAL,CAAU2B,SAAV,CAAoB,KAAK3B,IAAL,CAAUyB,QAAV,EAApB;cACA;YACD;;UACD,KAAK,eAAL;UACA,KAAK,gBAAL;YACE,KAAKzB,IAAL,CAAUuB,KAAV,CAAgBC,KAAhB,GAAwB,EAAE,GAAG,KAAKxB,IAAL,CAAUyB,QAAV,EAAL;cAA2B,GAAGG,IAAI,CAACC,KAAL,CAAWX,OAAO,CAACM,KAAnB;YAA9B,CAAxB;YACA,KAAKxB,IAAL,CAAU2B,SAAV,CAAoB,KAAK3B,IAAL,CAAUyB,QAAV,EAApB;YACA;;UAEF;QAhBF;MAkBD;IACF,CAtB0B,CAA3B;EAuBD;;EAEDK,OAAO,GAAI;IACT;IACA,KAAKC,YAAL,GAAoB,OAAOlB,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACmB,4BAA5D;;IACA,IAAI,KAAKD,YAAT,EAAuB;MACrB,KAAKvB,YAAL;MACA,KAAKR,IAAL,CAAUiC,EAAV,CAAa,cAAb,EAA6B,KAAK3B,iBAAlC;IACD;EACF;;EAED4B,SAAS,GAAI;IACX,IAAI,KAAKH,YAAT,EAAuB;MACrB,KAAKf,mBAAL;MACA,KAAKhB,IAAL,CAAUmC,GAAV,CAAc,cAAd,EAA8B,KAAKC,iBAAnC;IACD;EACF;;AAhEiD;AAA/BtC,a,CACZuC,O,GAAUxC,WAAW,CAACyC,O"}